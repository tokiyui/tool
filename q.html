<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>波浪モデル表示</title>
<style>
  body { background: #0b1020; color: #fff; font-family: sans-serif; text-align:center; }
  img { max-width: 90%; margin: 1em; border-radius: 6px; }
</style>
</head>
<body>
<h1>波浪モデル比較</h1>
<img id="gfs" alt="GFS 波浪">
<img id="ecmwf" alt="ECMWF 波浪">
<img id="gwam" alt="GWAM 波浪">

<script>
const proxy = "https://meteo.ryohorita105.workers.dev/?url=";

// 例：現在時刻 UTC の 5時間前を 12時間単位切り捨て
function floorTo12UTC(offsetHours){
  const d = new Date(Date.now() + new Date().getTimezoneOffset()*60000 - offsetHours*3600*1000);
  d.setUTCHours(d.getUTCHours()>=12?12:0,0,0,0);
  return d;
}

function fmt(d){
  return d.getUTCFullYear() +
    String(d.getUTCMonth()+1).padStart(2,'0') +
    String(d.getUTCDate()).padStart(2,'0') +
    String(d.getUTCHours()).padStart(2,'0');
}

const tGFS = floorTo12UTC(5);
const ft = 3;

const urls = {
  gfs:`https://img5.meteologix.com/images/data/cache/wave/wave_modwavegfs_${fmt(tGFS)}_${ft}_5731_297.png`,
  ecmwf:`https://img5.meteologix.com/images/data/cache/wave/wave_modwaveecmwf_${fmt(floorTo12UTC(8))}_${ft}_5731_297.png`,
  gwam:`https://img5.meteologix.com/images/data/cache/wave/wave_modgwam_${fmt(tGFS)}_${ft}_5731_297.png`
};

document.getElementById("gfs").src   = proxy + encodeURIComponent(urls.gfs);
document.getElementById("ecmwf").src = proxy + encodeURIComponent(urls.ecmwf);
document.getElementById("gwam").src  = proxy + encodeURIComponent(urls.gwam);
</script>
</body>
</html>
