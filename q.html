<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>波浪モデル表示</title>
<style>
  body { background: #0b1020; color: #fff; font-family: sans-serif; text-align:center; }
  img { max-width: 30%; margin: 0.5%; border-radius: 6px; vertical-align: top; }
  .time { font-size: 1.2em; margin-bottom: 1em; }
</style>
</head>
<body>
<h1>波浪モデル比較</h1>
<div class="time" id="model-time"></div>
<img id="gfs" alt="GFS 波浪">
<img id="ecmwf" alt="ECMWF 波浪">
<img id="gwam" alt="GWAM 波浪">

<script>
const proxy = "https://meteo.ryohorita105.workers.dev/?url=";

// UTC の時間を 12時間単位で切り捨て
function floorTo12UTC(offsetHours){
  const d = new Date(Date.now() + new Date().getTimezoneOffset()*60000 - offsetHours*3600*1000);
  d.setUTCHours(d.getUTCHours()>=12?12:0,0,0,0);
  return d;
}

function fmt(d){
  return d.getUTCFullYear() +
    String(d.getUTCMonth()+1).padStart(2,'0') +
    String(d.getUTCDate()).padStart(2,'0') +
    String(d.getUTCHours()).padStart(2,'0');
}

const tGFS = floorTo12UTC(5);
const tECMWF = floorTo12UTC(8);
const ft = 3;

// 画像 URL
const urls = {
  gfs: `https://img5.meteologix.com/images/data/cache/wave/wave_modwavegfs_${fmt(tGFS)}_${ft}_5731_297.png`,
  ecmwf: `https://img5.meteologix.com/images/data/cache/wave/wave_modwaveecmwf_${fmt(tECMWF)}_${ft}_5731_297.png`,
  gwam: `https://img5.meteologix.com/images/data/cache/wave/wave_modwavegwam_${fmt(tGFS)}_${ft}_5731_297.png`
};

// 時刻表示
document.getElementById("model-time").textContent =
  `表示時刻：${fmt(tGFS)} UTC (FT+${ft}h)`;

// 画像を Worker 経由で表示
document.getElementById("gfs").src   = proxy + encodeURIComponent(urls.gfs);
document.getElementById("ecmwf").src = proxy + encodeURIComponent(urls.ecmwf);
document.getElementById("gwam").src  = proxy + encodeURIComponent(urls.gwam);
</script>
</body>
</html>
